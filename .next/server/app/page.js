(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2887:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(4148),s(3733),s(996);var a=s(170),i=s(5002),r=s(3876),l=s.n(r),n=s(6299),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4148)),"/Users/akirayouky/Desktop/Siti/Condomini/src/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,3733)),"/Users/akirayouky/Desktop/Siti/Condomini/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,996,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/akirayouky/Desktop/Siti/Condomini/src/app/page.tsx"],m="/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1663:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,3642,23)),Promise.resolve().then(s.t.bind(s,7586,23)),Promise.resolve().then(s.t.bind(s,7838,23)),Promise.resolve().then(s.t.bind(s,8057,23)),Promise.resolve().then(s.t.bind(s,7741,23)),Promise.resolve().then(s.t.bind(s,3118,23))},5753:()=>{},8536:(e,t,s)=>{Promise.resolve().then(s.bind(s,9627))},9627:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(7247),i=s(8964);let r=(0,i.createContext)(null);function l({children:e}){let[t,s]=(0,i.useState)({isAuthenticated:!1,user:null,role:null}),l=async(e,t)=>{try{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),i=await a.json();if(i.success&&i.user)return s({isAuthenticated:!0,user:i.user,role:i.user.role}),!0;return!1}catch(e){return console.error("Errore durante il login:",e),!1}},n={...t,login:l,logout:()=>{s({isAuthenticated:!1,user:null,role:null})}};return a.jsx(r.Provider,{value:n,children:e})}function n(){let e=(0,i.useContext)(r);if(!e)throw Error("useAuth must be used within AuthProvider");return e}function o({onBack:e,onSuccess:t}){let[s,r]=(0,i.useState)({username:"",email:"",password:"",confirmPassword:"",nome:"",cognome:"",telefono:""}),[l,n]=(0,i.useState)(""),[o,d]=(0,i.useState)(!1),c=e=>{r(t=>({...t,[e.target.name]:e.target.value})),n("")},m=async e=>{if(e.preventDefault(),d(!0),n(""),s.password!==s.confirmPassword){n("Le password non coincidono"),d(!1);return}if(s.password.length<6){n("La password deve essere di almeno 6 caratteri"),d(!1);return}if(!s.email.includes("@")){n("Inserisci una email valida"),d(!1);return}try{let e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s.username,email:s.email,password:s.password,nome:s.nome,cognome:s.cognome,telefono:s.telefono})}),a=await e.json();a.success?t():n(a.message||"Errore nella registrazione")}catch(e){console.error("Errore registrazione:",e),n("Errore durante la registrazione")}finally{d(!1)}};return(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:a.jsx("span",{className:"text-2xl",children:"\uD83D\uDC77"})}),a.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Registrazione Sopralluoghista"}),a.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Crea il tuo account per accedere al portale verifiche"})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:m,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-700",children:"Nome *"}),a.jsx("input",{id:"nome",name:"nome",type:"text",required:!0,value:s.nome,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Nome"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"cognome",className:"block text-sm font-medium text-gray-700",children:"Cognome *"}),a.jsx("input",{id:"cognome",name:"cognome",type:"text",required:!0,value:s.cognome,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Cognome"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username *"}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:s.username,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Username per il login"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email *"}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:s.email,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"email@esempio.com"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"telefono",className:"block text-sm font-medium text-gray-700",children:"Telefono"}),a.jsx("input",{id:"telefono",name:"telefono",type:"tel",value:s.telefono,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"+39 123 456 7890"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password *"}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:s.password,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Minimo 6 caratteri"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Conferma Password *"}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:s.confirmPassword,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Ripeti la password"})]})]}),l&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,a.jsxs)("div",{className:"text-red-600 text-sm",children:["⚠️ ",l]})}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[a.jsx("button",{type:"button",onClick:e,className:"flex-1 py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"← Torna al Login"}),a.jsx("button",{type:"submit",disabled:o,className:"flex-1 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Registrazione..."]}):"✨ Registrati"})]}),a.jsx("div",{className:"bg-blue-50 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-blue-400",children:"ℹ️"})}),(0,a.jsxs)("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Processo di Approvazione"}),a.jsx("div",{className:"mt-2 text-sm text-blue-700",children:a.jsx("p",{children:"Dopo la registrazione, il tuo account sar\xe0 in attesa di approvazione da parte dell'amministratore. Riceverai una notifica via email quando potrai accedere al sistema."})})]})]})})]})]})}function d(){let[e,t]=(0,i.useState)({username:"",password:""}),[s,r]=(0,i.useState)(""),[l,d]=(0,i.useState)(!1),[c,m]=(0,i.useState)(!1),[x,u]=(0,i.useState)(!1),{login:h}=n(),g=async t=>{t.preventDefault(),d(!0),r("");try{await h(e.username,e.password)||r("Credenziali non valide. Controlla username e password.")}catch(e){r("Errore durante il login")}finally{d(!1)}},p=e=>{t(t=>({...t,[e.target.name]:e.target.value})),r("")};return c?a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsx(o,{onBack:()=>m(!1),onSuccess:()=>{u(!0),m(!1)}})}):a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100",children:a.jsx("span",{className:"text-2xl",children:"\uD83C\uDFE2"})}),a.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Verifiche Condominiali"}),a.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Accedi al sistema di gestione verifiche"})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:g,children:[(0,a.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"username",className:"sr-only",children:"Username"}),a.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:e.username,onChange:p,className:"relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Username"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),a.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:e.password,onChange:p,className:"relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),x&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:a.jsx("div",{className:"text-green-600 text-sm",children:"✅ Registrazione completata! Il tuo account \xe8 in attesa di approvazione."})}),s&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,a.jsxs)("div",{className:"text-red-600 text-sm",children:["⚠️ ",s]})}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Accesso..."]}):a.jsx(a.Fragment,{children:" Accedi"})})}),a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"button",onClick:()=>m(!c),className:"text-sm text-blue-600 hover:text-blue-500",children:c?"Torna al login":"Non hai un account? Registrati"})}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-md p-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Credenziali Test:"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[(0,a.jsxs)("p",{children:["� ",a.jsx("strong",{children:"Admin:"})," ",a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"admin"})," / ",a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"admin123"})]}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Gli altri account devono essere registrati"})]})]})]})]})})}let c="/api";class m{static async getAll(){try{let e=await fetch(`${c}/condomini`);return await e.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async getById(e){try{let t=await fetch(`${c}/condomini/${e}`);return await t.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async create(e){try{let t=await fetch(`${c}/condomini`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async update(e,t){try{let s=await fetch(`${c}/condomini/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await s.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async delete(e){try{let t=await fetch(`${c}/condomini/${e}`,{method:"DELETE"});return await t.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static validateCondominio(e){let t=[];return e.nome&&""!==e.nome.trim()||t.push("Il nome del condominio \xe8 obbligatorio"),e.nome&&e.nome.length<2&&t.push("Il nome deve essere di almeno 2 caratteri"),e.nome&&e.nome.length>100&&t.push("Il nome non pu\xf2 superare i 100 caratteri"),t}}function x(){let[e,t]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[r,l]=(0,i.useState)(null);return{condomini:e,loading:s,error:r,loadCondomini:async()=>{a(!0),l(null);let e=await m.getAll();e.success&&e.data?t(e.data):l(e.error||"Errore nel caricamento dei condomini"),a(!1)},createCondominio:async e=>{let s=m.validateCondominio(e);if(s.length>0)return l(s.join(", ")),!1;let a=await m.create(e);return a.success&&a.data?(t(e=>[...e,a.data]),l(null),!0):(l(a.error||"Errore nella creazione del condominio"),!1)},updateCondominio:async(e,s)=>{let a=m.validateCondominio(s);if(a.length>0)return l(a.join(", ")),!1;let i=await m.update(e,s);return i.success&&i.data?(t(t=>t.map(t=>t.id===e?i.data:t)),l(null),!0):(l(i.error||"Errore nell'aggiornamento del condominio"),!1)},deleteCondominio:async e=>{let s=await m.delete(e);return s.success?(t(t=>t.filter(t=>t.id!==e)),l(null),!0):(l(s.error||"Errore nell'eliminazione del condominio"),!1)},getCondominio:t=>e.find(e=>e.id===t||e.token===t),clearError:()=>l(null)}}function u({onSubmit:e,onCancel:t,loading:s=!1,initialData:r,isEdit:l=!1}){let[n,o]=(0,i.useState)({nome:r?.nome||""}),[d,c]=(0,i.useState)([]),m=async t=>{t.preventDefault(),c([]);let s=[];if(n.nome.trim()?n.nome.length<2?s.push("Il nome deve essere di almeno 2 caratteri"):n.nome.length>100&&s.push("Il nome non pu\xf2 superare i 100 caratteri"):s.push("Il nome del condominio \xe8 obbligatorio"),s.length>0){c(s);return}await e(n)&&!l&&o({nome:""})};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:l?"Modifica Condominio":"Nuovo Condominio"}),t&&a.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"✕"})]}),d.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:a.jsx("div",{className:"text-red-600 text-sm",children:d.map((e,t)=>(0,a.jsxs)("div",{children:["• ",e]},t))})}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Condominio *"}),a.jsx("input",{type:"text",id:"nome",name:"nome",value:n.nome,onChange:e=>{let{name:t,value:s}=e.target;o(e=>({...e,[t]:s})),d.length>0&&c([])},placeholder:"Es: Condominio Via Roma 123",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:s,maxLength:100}),(0,a.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[n.nome.length,"/100 caratteri"]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"submit",disabled:s||!n.nome.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:s?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),l?"Aggiornamento...":"Creazione..."]}):l?"Aggiorna Condominio":"Crea Condominio"}),t&&a.jsx("button",{type:"button",onClick:t,disabled:s,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annulla"})]})]})]})}function h({condomini:e,loading:t=!1,onEdit:s,onDelete:r,onView:l}){let[n,o]=(0,i.useState)(null),[d,c]=(0,i.useState)(null),m=async e=>{o(e);let t=await r(e);o(null),t&&c(null)},x=e=>new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),u=async e=>{try{await navigator.clipboard.writeText(e)}catch(e){console.error("Errore nel copiare il token:",e)}};return t?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Caricamento condomini..."})]})}):0===e.length?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83C\uDFE2"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nessun condominio trovato"}),a.jsx("p",{className:"text-gray-500",children:"Inizia creando il tuo primo condominio"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Condomini (",e.length,")"]})}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome Condominio"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Creazione"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ultima Modifica"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Azioni"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-blue-600 font-medium text-sm",children:e.nome.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.nome}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(e.data_inserimento)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(e.data_ultima_modifica)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[l&&a.jsx("button",{onClick:()=>l(e),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Visualizza dettagli",children:"\uD83D\uDC41️"}),a.jsx("button",{onClick:()=>u(e.token),className:"text-green-600 hover:text-green-900 transition-colors",title:"Copia Token",children:"\uD83D\uDD11"}),a.jsx("button",{onClick:()=>s(e),className:"text-indigo-600 hover:text-indigo-900 transition-colors",title:"Modifica",children:"✏️"}),a.jsx("button",{onClick:()=>c(e.id),className:"text-red-600 hover:text-red-900 transition-colors",title:"Elimina",children:"\uD83D\uDDD1️"})]})})]},e.id))})]})})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 mx-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Conferma eliminazione"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Sei sicuro di voler eliminare questo condominio? Questa azione non pu\xf2 essere annullata."}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>c(null),disabled:n===d,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annulla"}),a.jsx("button",{onClick:()=>m(d),disabled:n===d,className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors disabled:bg-red-300 disabled:cursor-not-allowed",children:n===d?(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Eliminazione..."]}):"Elimina"})]})]})})]})}function g(){let{condomini:e,loading:t,error:s,createCondominio:r,updateCondominio:l,deleteCondominio:n,clearError:o}=x(),[d,c]=(0,i.useState)(!1),[m,g]=(0,i.useState)(null),[p,b]=(0,i.useState)(!1),[j,v]=(0,i.useState)(null),f=async e=>{b(!0);let t=await r(e);return b(!1),t&&(c(!1),v("Condominio creato con successo!")),t},y=async e=>{if(!m)return!1;b(!0);let t=await l(m.id,e);return b(!1),t&&(g(null),v("Condominio aggiornato con successo!")),t},N=async e=>{let t=await n(e);return t&&v("Condominio eliminato con successo!"),t},w={totale:e.length,recenti:e.filter(e=>{let t=new Date(e.data_inserimento),s=new Date;return s.setDate(s.getDate()-7),t>=s}).length};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Gestione Condomini"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Gestisci l'anagrafica dei condomini e i relativi token di accesso"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 px-4 py-3 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w.totale}),a.jsx("div",{className:"text-sm text-blue-800",children:"Totale"})]}),(0,a.jsxs)("div",{className:"bg-green-50 px-4 py-3 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:w.recenti}),a.jsx("div",{className:"text-sm text-green-800",children:"Ultimi 7gg"})]})]})]}),s&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-red-400 mr-3",children:"❌"}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-red-800 font-medium",children:"Errore"}),a.jsx("p",{className:"text-red-700 text-sm mt-1",children:s})]}),a.jsx("button",{onClick:o,className:"ml-auto text-red-400 hover:text-red-600",children:"✕"})]})}),j&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-green-400 mr-3",children:"✅"}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-green-800 font-medium",children:"Successo"}),a.jsx("p",{className:"text-green-700 text-sm mt-1",children:j})]}),a.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-400 hover:text-green-600",children:"✕"})]})}),a.jsx("div",{className:"flex justify-between items-center",children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{c(!0),g(null)},className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[a.jsx("span",{children:"➕"}),"Nuovo Condominio"]}),(0,a.jsxs)("button",{onClick:()=>window.location.reload(),className:"bg-gray-100 text-gray-600 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDD04"}),"Ricarica"]})]})}),d&&a.jsx(u,{onSubmit:f,onCancel:()=>c(!1),loading:p}),m&&a.jsx(u,{onSubmit:y,onCancel:()=>{g(null)},loading:p,initialData:{nome:m.nome},isEdit:!0}),a.jsx(h,{condomini:e,loading:t,onEdit:e=>{g(e),c(!1)},onDelete:N})]})}class p{static{this.API_BASE="/api/tipologie"}static async getAll(){try{let e=await fetch(this.API_BASE);return await e.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async getById(e){try{let t=await fetch(`${this.API_BASE}/${e}`);return await t.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async create(e){try{let t=await fetch(this.API_BASE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async update(e,t){try{let s=await fetch(`${this.API_BASE}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await s.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static async delete(e){try{let t=await fetch(`${this.API_BASE}/${e}`,{method:"DELETE"});return await t.json()}catch(e){return{success:!1,error:"Errore di connessione"}}}static validate(e){let t=[];return e.nome&&""!==e.nome.trim()||t.push("Il nome della tipologia \xe8 obbligatorio"),e.nome&&e.nome.length<2&&t.push("Il nome deve essere di almeno 2 caratteri"),t}}function b(){let[e,t]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[r,l]=(0,i.useState)(null);return{tipologie:e,loading:s,error:r,loadTipologie:async()=>{a(!0),l(null);let e=await p.getAll();e.success&&e.data?t(e.data):l(e.error||"Errore nel caricamento delle tipologie"),a(!1)},createTipologia:async e=>{let s=p.validate(e);if(s.length>0)return l(s.join(", ")),!1;let a=await p.create(e);return a.success&&a.data?(t(e=>[...e,a.data]),l(null),!0):(l(a.error||"Errore nella creazione della tipologia"),!1)},updateTipologia:async(e,s)=>{let a=p.validate(s);if(a.length>0)return l(a.join(", ")),!1;let i=await p.update(e,s);return i.success&&i.data?(t(t=>t.map(t=>t.id===e?i.data:t)),l(null),!0):(l(i.error||"Errore nell'aggiornamento della tipologia"),!1)},deleteTipologia:async e=>{let s=await p.delete(e);return s.success?(t(t=>t.filter(t=>t.id!==e)),l(null),!0):(l(s.error||"Errore nell'eliminazione della tipologia"),!1)},getTipologia:t=>e.find(e=>e.id===t),getTipologieAttive:()=>e.filter(e=>e.attiva),clearError:()=>l(null)}}function j({onSubmit:e,onCancel:t,loading:s=!1,initialData:r,isEdit:l=!1}){let[n,o]=(0,i.useState)({nome:r?.nome||"",descrizione:r?.descrizione||"",campi_personalizzati:r?.campi_personalizzati||[]}),[d,c]=(0,i.useState)([]),m=[{value:"testo",label:"Testo"},{value:"numero",label:"Numero"},{value:"data",label:"Data"},{value:"checkbox",label:"Checkbox"},{value:"select",label:"Lista selezione"},{value:"textarea",label:"Testo lungo"},{value:"foto",label:"\uD83D\uDCF7 Caricamento Foto"}],x=async t=>{t.preventDefault(),c([]);let s=[];if(n.nome.trim()||s.push("Il nome della tipologia \xe8 obbligatorio"),s.length>0){c(s);return}await e(n)&&!l&&o({nome:"",descrizione:"",campi_personalizzati:[]})},u=e=>{let{name:t,value:s}=e.target;o(e=>({...e,[t]:s})),d.length>0&&c([])},h=e=>{o(t=>({...t,campi_personalizzati:t.campi_personalizzati.filter((t,s)=>s!==e)}))},g=(e,t)=>{o(s=>({...s,campi_personalizzati:s.campi_personalizzati.map((s,a)=>a===e?{...s,...t}:s)}))};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:l?"Modifica Tipologia":"Nuova Tipologia"}),t&&a.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"✕"})]}),d.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:a.jsx("div",{className:"text-red-600 text-sm",children:d.map((e,t)=>(0,a.jsxs)("div",{children:["• ",e]},t))})}),(0,a.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Tipologia *"}),a.jsx("input",{type:"text",name:"nome",value:n.nome,onChange:u,placeholder:"Es: Verifica Antincendio",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:s})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrizione"}),a.jsx("textarea",{name:"descrizione",value:n.descrizione,onChange:u,placeholder:"Descrivi brevemente questa tipologia di verifica...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:s})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Campi Personalizzati"}),a.jsx("button",{type:"button",onClick:()=>{let e={nome:"",tipo:"testo",obbligatorio:!1};o(t=>({...t,campi_personalizzati:[...t.campi_personalizzati,e]}))},disabled:s,className:"bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors",children:"+ Aggiungi Campo"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[n.campi_personalizzati.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 p-4 rounded-md",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("h5",{className:"font-medium text-gray-700",children:["Campo #",t+1]}),a.jsx("button",{type:"button",onClick:()=>h(t),className:"text-red-500 hover:text-red-700",children:"\uD83D\uDDD1️"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nome Campo"}),a.jsx("input",{type:"text",value:e.nome,onChange:e=>g(t,{nome:e.target.value}),placeholder:"Es: Numero estintori",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tipo"}),a.jsx("select",{value:e.tipo,onChange:e=>g(t,{tipo:e.target.value}),title:"Tipo di campo",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm",children:m.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Placeholder"}),a.jsx("input",{type:"text",value:e.placeholder||"",onChange:e=>g(t,{placeholder:e.target.value}),placeholder:"Testo di aiuto...",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),a.jsx("div",{className:"flex items-center",children:(0,a.jsxs)("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.obbligatorio,onChange:e=>g(t,{obbligatorio:e.target.checked}),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Campo obbligatorio"})]})}),"select"===e.tipo&&(0,a.jsxs)("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Opzioni (una per riga)"}),a.jsx("textarea",{value:e.opzioni?.join("\n")||"",onChange:e=>g(t,{opzioni:e.target.value.split("\n").filter(e=>""!==e.trim())}),placeholder:"Opzione 1\\nOpzione 2\\nOpzione 3",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),"foto"===e.tipo&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Massimo foto consentite"}),a.jsx("input",{type:"number",min:"1",max:"10",value:e.maxFoto||5,onChange:e=>g(t,{maxFoto:parseInt(e.target.value)||5}),placeholder:"5",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Numero massimo di foto che gli utenti possono caricare (1-10)"})]})]})]},t)),0===n.campi_personalizzati.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDD"}),a.jsx("p",{children:"Nessun campo personalizzato configurato"}),(0,a.jsxs)("p",{className:"text-sm",children:["                ",a.jsx("p",{children:'Clicca su "Aggiungi Campo" per iniziare'})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"submit",disabled:s||!n.nome.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:s?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),l?"Aggiornamento...":"Creazione..."]}):l?"Aggiorna Tipologia":"Crea Tipologia"}),t&&a.jsx("button",{type:"button",onClick:t,disabled:s,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annulla"})]})]})]})}function v({tipologie:e,loading:t=!1,onEdit:s,onDelete:r,onToggleActive:l}){let[n,o]=(0,i.useState)(null),[d,c]=(0,i.useState)(null),m=async e=>{o(e);let t=await r(e);o(null),t&&c(null)},x=e=>new Date(e).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric"});return t?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Caricamento tipologie..."})]})}):0===e.length?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDCCB"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nessuna tipologia trovata"}),a.jsx("p",{className:"text-gray-500",children:"Inizia creando la tua prima tipologia di verifica"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Tipologie Verifiche (",e.length,")"]})}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipologia"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campi Configurati"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stato"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Creazione"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Azioni"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-purple-600 font-medium",children:e.nome.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.nome}),a.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:e.descrizione||"Nessuna descrizione"})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.campi_personalizzati.length}),a.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"campi"}),e.campi_personalizzati.some(e=>e.obbligatorio)&&a.jsx("span",{className:"ml-2 text-xs bg-red-100 text-red-600 px-2 py-1 rounded",children:"obbligatori"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.attiva?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.attiva?"✓ Attiva":"○ Disattiva"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(e.data_creazione)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[l&&a.jsx("button",{onClick:()=>l(e.id,!e.attiva),className:`text-sm px-2 py-1 rounded transition-colors ${e.attiva?"text-yellow-600 hover:text-yellow-900":"text-green-600 hover:text-green-900"}`,title:e.attiva?"Disattiva":"Attiva",children:e.attiva?"⏸️":"▶️"}),a.jsx("button",{onClick:()=>s(e),className:"text-indigo-600 hover:text-indigo-900 transition-colors",title:"Modifica",children:"✏️"}),a.jsx("button",{onClick:()=>c(e.id),className:"text-red-600 hover:text-red-900 transition-colors",title:"Elimina",children:"\uD83D\uDDD1️"})]})})]},e.id))})]})})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 mx-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Conferma eliminazione"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Sei sicuro di voler eliminare questa tipologia? Questa azione non pu\xf2 essere annullata."}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>c(null),disabled:n===d,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annulla"}),a.jsx("button",{onClick:()=>m(d),disabled:n===d,className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors disabled:bg-red-300 disabled:cursor-not-allowed",children:n===d?(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Eliminazione..."]}):"Elimina"})]})]})})]})}function f(){let{tipologie:e,loading:t,error:s,createTipologia:r,updateTipologia:l,deleteTipologia:n,clearError:o}=b(),[d,c]=(0,i.useState)(!1),[m,x]=(0,i.useState)(null),[u,h]=(0,i.useState)(!1),[g,p]=(0,i.useState)(null),f=async e=>{h(!0);let t=await r(e);return h(!1),t&&(c(!1),p("Tipologia creata con successo!")),t},y=async e=>{if(!m)return!1;let t={...e,attiva:m.attiva};h(!0);let s=await l(m.id,t);return h(!1),s&&(x(null),p("Tipologia aggiornata con successo!")),s},N=async e=>{let t=await n(e);return t&&p("Tipologia eliminata con successo!"),t},w=async(t,s)=>{let a=e.find(e=>e.id===t);if(!a)return!1;let i={nome:a.nome,descrizione:a.descrizione,campi_personalizzati:a.campi_personalizzati,attiva:s},r=await l(t,i);return r&&p(`Tipologia ${s?"attivata":"disattivata"} con successo!`),r},C={totale:e.length,attive:e.filter(e=>e.attiva).length,conCampi:e.filter(e=>e.campi_personalizzati.length>0).length};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Tipologie Verifiche"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Configura le diverse tipologie di verifiche e i relativi campi personalizzati"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"bg-purple-50 px-4 py-3 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:C.totale}),a.jsx("div",{className:"text-sm text-purple-800",children:"Totale"})]}),(0,a.jsxs)("div",{className:"bg-green-50 px-4 py-3 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:C.attive}),a.jsx("div",{className:"text-sm text-green-800",children:"Attive"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 px-4 py-3 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:C.conCampi}),a.jsx("div",{className:"text-sm text-blue-800",children:"Con Campi"})]})]})]}),s&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-red-400 mr-3",children:"❌"}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-red-800 font-medium",children:"Errore"}),a.jsx("p",{className:"text-red-700 text-sm mt-1",children:s})]}),a.jsx("button",{onClick:o,className:"ml-auto text-red-400 hover:text-red-600",children:"✕"})]})}),g&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-green-400 mr-3",children:"✅"}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-green-800 font-medium",children:"Successo"}),a.jsx("p",{className:"text-green-700 text-sm mt-1",children:g})]}),a.jsx("button",{onClick:()=>p(null),className:"ml-auto text-green-400 hover:text-green-600",children:"✕"})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{c(!0),x(null)},className:"bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",children:[a.jsx("span",{children:"➕"}),"Nuova Tipologia"]}),(0,a.jsxs)("button",{onClick:()=>window.location.reload(),className:"bg-gray-100 text-gray-600 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDD04"}),"Ricarica"]})]}),a.jsx("div",{className:"text-sm text-gray-500",children:"\uD83D\uDCA1 Le tipologie disattive non appariranno nel wizard verifiche"})]}),d&&a.jsx(j,{onSubmit:f,onCancel:()=>c(!1),loading:u}),m&&a.jsx(j,{onSubmit:y,onCancel:()=>{x(null)},loading:u,initialData:{nome:m.nome,descrizione:m.descrizione,campi_personalizzati:m.campi_personalizzati,attiva:m.attiva},isEdit:!0}),a.jsx(v,{tipologie:e,loading:t,onEdit:e=>{x(e),c(!1)},onDelete:N,onToggleActive:w})]})}function y({value:e=[],onChange:t,maxFoto:s=5,required:r=!1,nome:l}){let[n,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),m=(0,i.useRef)(null),x=async a=>{let i=a.target.files;if(i){if(e.length+i.length>s){c(`Puoi caricare al massimo ${s} foto`);return}o(!0),c(null);try{let s=[];for(let e=0;e<i.length;e++){let t=i[e];if(!t.type.startsWith("image/")){c("Sono accettati solo file immagine");continue}if(t.size>5242880){c("Le immagini non possono superare i 5MB");continue}let a=await u(t),r=await h(a,1920);s.push(r)}s.length>0&&t([...e,...s])}catch(e){c("Errore durante il caricamento delle foto"),console.error("Error uploading photos:",e)}finally{o(!1),m.current&&(m.current.value="")}}},u=e=>new Promise((t,s)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>s(e)}),h=(e,t)=>new Promise(s=>{let a=new Image;a.onload=()=>{let e=document.createElement("canvas"),i=e.getContext("2d"),{width:r,height:l}=a;r>t&&(l=l*t/r,r=t),e.width=r,e.height=l,i.drawImage(a,0,0,r,l),s(e.toDataURL("image/jpeg",.85))},a.src=e}),g=s=>{t(e.filter((e,t)=>t!==s))},p=t=>{let s=window.open("","_blank");s&&(s.document.write(`
        <html>
          <head><title>Foto ${t+1} - ${l}</title></head>
          <body style="margin:0;background:#000;display:flex;justify-content:center;align-items:center;height:100vh;">
            <img src="${e[t]}" style="max-width:100%;max-height:100%;object-fit:contain;" />
          </body>
        </html>
      `),s.document.close())};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[a.jsx("input",{ref:m,type:"file",multiple:!0,accept:"image/*",onChange:x,className:"hidden",id:`foto-upload-${l}`}),a.jsx("div",{className:"space-y-3",children:n?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"text-gray-600",children:"Caricamento..."})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"text-4xl text-gray-400",children:"\uD83D\uDCF7"}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:`foto-upload-${l}`,className:"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"\uD83D\uDCC1 Seleziona Foto"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Clicca per selezionare o trascina le foto qui",a.jsx("br",{}),(0,a.jsxs)("span",{className:"text-xs",children:["Massimo ",s," foto • JPG, PNG • Max 5MB ciascuna"]})]})]}),e.length<s&&(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:[e.length,"/",s," foto caricate"]})]})})]}),d&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,a.jsxs)("div",{className:"text-red-600 text-sm",children:["⚠️ ",d]})}),e.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-700",children:["Foto caricate (",e.length,")",r&&0===e.length&&a.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[a.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden border-2 border-gray-200",children:a.jsx("img",{src:e,alt:`Foto ${t+1}`,className:"w-full h-full object-cover cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>p(t)})}),a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>p(t),className:"p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all",title:"Visualizza a schermo intero",children:"\uD83D\uDC41️"}),a.jsx("button",{onClick:()=>g(t),className:"p-2 bg-red-500 bg-opacity-90 text-white rounded-full hover:bg-opacity-100 transition-all",title:"Rimuovi foto",children:"\uD83D\uDDD1️"})]})}),a.jsx("div",{className:"absolute top-2 left-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:t+1})]},t))})]}),r&&0===e.length&&a.jsx("div",{className:"text-red-600 text-sm",children:"Almeno una foto \xe8 richiesta per questo campo"})]})}function N({selectedCondominio:e,selectedTipologia:t,onCondominioChange:s,onTipologiaChange:i,onNext:r,canProceed:l}){let{condomini:n,loading:o}=x(),{tipologie:d,loading:c}=b(),m=d.filter(e=>e.attiva);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Step 1: Selezione Condominio e Tipologia"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Seleziona il condominio da verificare e il tipo di verifica da eseguire"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Seleziona Condominio *"}),o?a.jsx("div",{className:"animate-pulse",children:a.jsx("div",{className:"h-12 bg-gray-200 rounded-md"})}):n.length>0?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("select",{value:e?.id||"",onChange:e=>{let t=n.find(t=>t.id===e.target.value);t&&s(t)},title:"Seleziona un condominio",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900 appearance-none cursor-pointer",children:[a.jsx("option",{value:"",disabled:!0,children:"\uD83C\uDFE2 Seleziona un condominio..."}),n.map(e=>a.jsx("option",{value:e.id,children:e.nome},e.id))]}),e&&a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4",children:a.jsx("span",{className:"text-blue-600 font-bold text-lg",children:e.nome.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-blue-900",children:e.nome}),(0,a.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:["Aggiunto il ",new Date(e.data_inserimento).toLocaleDateString("it-IT")]})]}),a.jsx("div",{className:"text-blue-500 text-2xl",children:"✓"})]})})]}):null,!o&&0===n.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\uD83C\uDFE2"}),a.jsx("p",{children:"Nessun condominio disponibile"}),a.jsx("p",{className:"text-sm",children:"Aggiungi prima un condominio nella sezione apposita"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Seleziona Tipologia Verifica *"}),c?a.jsx("div",{className:"animate-pulse",children:a.jsx("div",{className:"h-10 bg-gray-200 rounded-md"})}):a.jsx("div",{className:"grid grid-cols-1 gap-3",children:m.map(e=>a.jsx("button",{onClick:()=>i(e),className:`p-4 border-2 rounded-lg text-left transition-all ${t?.id===e.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"}`,children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3 mt-1",children:a.jsx("span",{className:"text-green-600 font-medium",children:e.nome.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.nome}),a.jsx("div",{className:"text-sm text-gray-500 mt-1",children:e.descrizione}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 mt-2",children:[e.campi_personalizzati.length," campi configurati"]})]})]}),t?.id===e.id&&a.jsx("div",{className:"text-green-500 text-xl",children:"✓"})]})},e.id))}),!c&&0===m.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCCB"}),a.jsx("p",{children:"Nessuna tipologia di verifica attiva"}),a.jsx("p",{className:"text-sm",children:"Configura prima le tipologie nella sezione apposita"})]})]}),e&&t&&(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Riepilogo Selezioni:"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Condominio:"})," ",e.nome]}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Tipologia:"})," ",t.nome]}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Campi da compilare:"})," ",t.campi_personalizzati.length]})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:(0,a.jsxs)("button",{onClick:r,disabled:!l,className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-2",children:["Continua",a.jsx("span",{children:"→"})]})})]})}function w({tipologia:e,datiVerifica:t,onDatiChange:s,onNext:r,onPrevious:l,canProceed:n}){let[o,d]=(0,i.useState)({}),c=(e,a)=>{if(s({...t,[e.nome]:a}),o[e.nome]){let t={...o};delete t[e.nome],d(t)}},m=()=>{let s={};return e.campi_personalizzati.forEach(e=>{if(e.obbligatorio){let a=t[e.nome];"foto"===e.tipo?a&&Array.isArray(a)&&0!==a.length||(s[e.nome]="Almeno una foto \xe8 richiesta"):a&&("string"!=typeof a||""!==a.trim())||(s[e.nome]="Questo campo \xe8 obbligatorio")}}),d(s),0===Object.keys(s).length},x=e=>{let s=t[e.nome]||"",i=o[e.nome];switch(e.tipo){case"testo":return a.jsx("input",{type:"text",value:s,onChange:t=>c(e,t.target.value),placeholder:e.placeholder,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border-red-500":"border-gray-300"}`});case"numero":return a.jsx("input",{type:"number",value:s,onChange:t=>c(e,parseFloat(t.target.value)||""),placeholder:e.placeholder,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border-red-500":"border-gray-300"}`});case"data":return a.jsx("input",{type:"date",value:s,onChange:t=>c(e,t.target.value),title:e.nome,placeholder:e.placeholder,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border-red-500":"border-gray-300"}`});case"checkbox":return(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:!0===s,onChange:t=>c(e,t.target.checked),title:e.nome,placeholder:e.placeholder,className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:e.placeholder||"Seleziona se applicabile"})]});case"select":return(0,a.jsxs)("select",{value:s,onChange:t=>c(e,t.target.value),title:e.nome,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border-red-500":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Seleziona..."}),e.opzioni?.map((e,t)=>a.jsx("option",{value:e,children:e},t))]});case"textarea":return a.jsx("textarea",{value:s,onChange:t=>c(e,t.target.value),placeholder:e.placeholder,rows:4,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border-red-500":"border-gray-300"}`});case"foto":return a.jsx(y,{value:s||[],onChange:t=>c(e,t),maxFoto:e.maxFoto||5,required:e.obbligatorio,nome:e.nome});default:return null}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Step 2: Compilazione Dati Verifica"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-4",children:["Compila i campi richiesti per la verifica: ",a.jsx("strong",{children:e.nome})]}),a.jsx("div",{className:"text-sm text-gray-500",children:"Campi obbligatori contrassegnati con *"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[e.campi_personalizzati.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.nome,e.obbligatorio&&a.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),x(e),o[e.nome]&&a.jsx("div",{className:"text-red-500 text-sm mt-1",children:o[e.nome]})]},e.id)),0===e.campi_personalizzati.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDD"}),a.jsx("p",{children:"Nessun campo configurato per questa tipologia"}),a.jsx("p",{className:"text-sm",children:"Puoi procedere direttamente al passo successivo"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,a.jsxs)("button",{onClick:l,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors flex items-center gap-2",children:[a.jsx("span",{children:"←"}),"Indietro"]}),(0,a.jsxs)("button",{onClick:()=>{m()&&r()},disabled:!n,className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-2",children:["Continua",a.jsx("span",{children:"→"})]})]})]})}function C({condominio:e,tipologia:t,datiVerifica:s,note:i,onNoteChange:r,onComplete:l,onPrevious:n,loading:o=!1}){return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Step 3: Riepilogo e Completamento"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Verifica i dati inseriti e completa la verifica"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Riepilogo Verifica"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Informazioni Generali"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Condominio:"})," ",e.nome]}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Tipologia:"})," ",t.nome]}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Data:"})," ",new Date().toLocaleDateString("it-IT")]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Dati Raccolti"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[Object.entries(s).map(([e,t])=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("strong",{children:[e,":"]})," ","boolean"==typeof t?t?"S\xec":"No":String(t)]},e)),0===Object.keys(s).length&&a.jsx("div",{className:"text-gray-500 italic",children:"Nessun dato raccolto"})]})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note Aggiuntive"}),a.jsx("textarea",{value:i,onChange:e=>r(e.target.value),placeholder:"Inserisci eventuali note, osservazioni o commenti sulla verifica...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:o})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-medium text-blue-800 mb-2",children:"Opzioni di Completamento"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-blue-700",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"\uD83D\uDCE7"}),"Email di notifica sar\xe0 inviata automaticamente"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"\uD83D\uDCBE"}),"I dati verranno salvati nel sistema"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"\uD83D\uDCCB"}),"La verifica sar\xe0 disponibile nel pannello amministratore"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,a.jsxs)("button",{onClick:n,disabled:o,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50 flex items-center gap-2",children:[a.jsx("span",{children:"←"}),"Indietro"]}),a.jsx("button",{onClick:l,disabled:o,className:"bg-green-500 text-white px-8 py-3 rounded-lg hover:bg-green-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-2",children:o?(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Completamento..."]}):a.jsx(a.Fragment,{children:"✓ Completa Verifica"})})]})]})}function D({lavorazione:e,onLavorazioneComplete:t,onBack:s}){let r=!!e,[l,n]=(0,i.useState)(r?2:1),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)(null),[x,u]=(0,i.useState)({}),[h,g]=(0,i.useState)(""),[p,b]=(0,i.useState)(!1),[j,v]=(0,i.useState)(!1),f=async()=>{if(r&&e&&"da_eseguire"===e.stato)try{await fetch(`/api/lavorazioni/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"inizia",nota:"Verifica iniziata dal sopralluoghista"})})}catch(e){console.error("Errore nell'iniziare la lavorazione:",e)}n(3)},y=()=>{if(r&&2===l){s&&s();return}n(e=>e-1)},D=async()=>{if(o&&c){b(!0);try{if(r&&e){let s=await fetch(`/api/lavorazioni/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"completa",dati_verifica:x,nota:h})}),a=await s.json();a.success?(v(!0),setTimeout(()=>{t&&t(e.id)},2e3)):alert("Errore nel completamento della lavorazione: "+a.error)}else{let e={condominio_id:o.id,tipologia_id:c.id,dati_verifica:x,note:h},t=await fetch("/api/verifiche",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();s.success?(v(!0),setTimeout(()=>{n(r?2:1),d(null),m(null),u({}),g(""),v(!1)},3e3)):alert("Errore nel completamento della verifica: "+s.error)}}catch(e){alert("Errore di connessione")}b(!1)}},z=!!(o&&c),k=!c||c.campi_personalizzati.filter(e=>e.obbligatorio).every(e=>x[e.nome]&&""!==x[e.nome]);return j?a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-green-500 text-6xl mb-4",children:"✅"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:r?"Lavorazione Completata!":"Verifica Completata con Successo!"}),(0,a.jsxs)("div",{className:"space-y-2 text-gray-600 mb-6",children:[(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Condominio:"})," ",o?.nome]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Tipologia:"})," ",c?.nome]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Data:"})," ",new Date().toLocaleDateString("it-IT")]}),r&&e&&(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Lavorazione:"})," #",e.id]})]}),a.jsx("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-center text-green-700",children:[a.jsx("span",{className:"mr-2",children:r?"✅":"\uD83D\uDCE7"}),r?"Lavorazione aggiornata e notificata all'amministratore":"Email di notifica inviata con successo"]})}),a.jsx("p",{className:"text-sm text-gray-500",children:"Reindirizzamento automatico in corso..."})]})})}):(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:r?"Completa Lavorazione":"Wizard Verifiche"}),r&&e&&(0,a.jsxs)("p",{className:"text-gray-600 mb-4",children:[(0,a.jsxs)("strong",{children:["Lavorazione #",e.id,":"]})," ",e.descrizione]}),a.jsx("div",{className:"flex items-center justify-between mb-6",children:(r?[2,3]:[1,2,3]).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium ${e<l?"bg-green-500 text-white":e===l?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:e<l?"✓":e}),t<(r?[2,3]:[1,2,3]).length-1&&a.jsx("div",{className:`w-16 md:w-32 h-1 mx-2 ${e<l?"bg-green-500":"bg-gray-200"}`})]},e))}),(0,a.jsxs)("div",{className:`flex justify-between text-sm text-gray-600 ${r?"justify-around":""}`,children:[!r&&a.jsx("span",{className:1===l?"font-medium text-blue-600":"",children:"Selezione"}),a.jsx("span",{className:2===l?"font-medium text-blue-600":"",children:"Compilazione"}),a.jsx("span",{className:3===l?"font-medium text-blue-600":"",children:"Riepilogo"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[1===l&&!r&&a.jsx(N,{selectedCondominio:o,selectedTipologia:c,onCondominioChange:d,onTipologiaChange:m,onNext:()=>{o&&c&&n(2)},canProceed:z}),2===l&&c&&a.jsx(w,{tipologia:c,datiVerifica:x,onDatiChange:u,onNext:f,onPrevious:y,canProceed:k}),3===l&&o&&c&&a.jsx(C,{condominio:o,tipologia:c,datiVerifica:x,note:h,onNoteChange:g,onComplete:D,onPrevious:y,loading:p})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsxs)("button",{onClick:()=>{n(1),d(null),m(null),u({}),g(""),v(!1)},className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:[a.jsx("span",{children:"\uD83D\uDD04"}),"Ricomincia"]}),a.jsx("div",{className:"text-sm text-gray-500",children:"\uD83D\uDCA1 I dati vengono salvati automaticamente ad ogni passaggio"})]})]})}function z({foto:e,nome:t}){let[s,r]=(0,i.useState)(null);if(!e||0===e.length)return null;let l=e=>{r(e)},n=s=>{let a=document.createElement("a");a.href=e[s],a.download=`${t}_foto_${s+1}.jpg`,document.body.appendChild(a),a.click(),document.body.removeChild(a)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("h5",{className:"text-sm font-medium text-gray-700",children:["\uD83D\uDCF7 ",t," (",e.length," foto)"]})}),a.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:e.map((e,s)=>(0,a.jsxs)("div",{className:"relative group cursor-pointer",children:[a.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden border-2 border-gray-200 hover:border-blue-400 transition-colors",children:a.jsx("img",{src:e,alt:`Foto ${s+1} - ${t}`,className:"w-full h-full object-cover hover:scale-105 transition-transform",onClick:()=>l(s)})}),a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-60 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>l(s),className:"p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all",title:"Visualizza",children:"\uD83D\uDC41️"}),a.jsx("button",{onClick:()=>n(s),className:"p-2 bg-blue-500 bg-opacity-90 text-white rounded-full hover:bg-opacity-100 transition-all",title:"Scarica",children:"\uD83D\uDCBE"})]})}),a.jsx("div",{className:"absolute top-2 left-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:s+1})]},s))})]}),null!==s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[a.jsx("img",{src:e[s],alt:`Foto ${s+1} - ${t}`,className:"max-w-full max-h-full object-contain"}),a.jsx("div",{className:"absolute top-4 left-4 text-white",children:(0,a.jsxs)("div",{className:"bg-black bg-opacity-75 px-4 py-2 rounded-lg",children:[a.jsx("div",{className:"font-medium",children:t}),(0,a.jsxs)("div",{className:"text-sm text-gray-300",children:["Foto ",s+1," di ",e.length]})]})}),s>0&&a.jsx("button",{onClick:()=>{null!==s&&s>0&&r(s-1)},className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-75 text-white p-4 rounded-full hover:bg-opacity-90 transition-all",title:"Foto precedente",children:"⬅️"}),s<e.length-1&&a.jsx("button",{onClick:()=>{null!==s&&s<e.length-1&&r(s+1)},className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-75 text-white p-4 rounded-full hover:bg-opacity-90 transition-all",title:"Foto successiva",children:"➡️"}),(0,a.jsxs)("div",{className:"absolute bottom-4 right-4 flex space-x-3",children:[a.jsx("button",{onClick:()=>n(s),className:"bg-blue-500 bg-opacity-90 text-white px-4 py-2 rounded-lg hover:bg-opacity-100 transition-all",title:"Scarica foto",children:"\uD83D\uDCBE Scarica"}),a.jsx("button",{onClick:()=>{r(null)},className:"bg-red-500 bg-opacity-90 text-white px-4 py-2 rounded-lg hover:bg-opacity-100 transition-all",title:"Chiudi",children:"❌ Chiudi"})]}),a.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2 bg-black bg-opacity-75 p-3 rounded-lg max-w-xs overflow-x-auto",children:e.map((e,t)=>a.jsx("div",{onClick:()=>r(t),className:`cursor-pointer w-12 h-12 rounded overflow-hidden border-2 transition-all ${s===t?"border-blue-400":"border-gray-600 hover:border-gray-400"}`,children:a.jsx("img",{src:e,alt:`Miniatura ${t+1}`,className:"w-full h-full object-cover"})},t))})]})})]})}function k(){let[e,t]=(0,i.useState)([]),[s,r]=(0,i.useState)(!0),[l,n]=(0,i.useState)(null),o=async()=>{try{let e=await fetch("/api/users"),s=await e.json();s.success?t(s.data):n(s.error)}catch(e){n("Errore nel caricamento degli utenti")}finally{r(!1)}},d=async e=>{try{let t=await fetch(`/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"approve"})}),s=await t.json();s.success?(await o(),alert("Utente approvato con successo!")):alert("Errore nell'approvazione: "+s.error)}catch(e){alert("Errore nell'approvazione dell'utente")}},c=async e=>{if(confirm("Sei sicuro di voler rifiutare questo utente? Verr\xe0 rimosso dalla lista di attesa."))try{let t=await fetch(`/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"reject"})}),s=await t.json();s.success?(await o(),alert("Utente rifiutato e rimosso dalla lista di attesa")):alert("Errore nel rifiuto: "+s.error)}catch(e){alert("Errore nel rifiuto dell'utente")}},m=async e=>{if(confirm("Resettare la password? Verr\xe0 generata una password temporanea da comunicare all'utente."))try{let t=await fetch(`/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"reset_password"})}),s=await t.json();s.success&&s.tempPassword?(alert(`Password temporanea generata!

Username: ${s.username}
Password temporanea: ${s.tempPassword}

Comunica queste credenziali all'utente.
Al primo accesso dovr\xe0 cambiare la password.`),navigator.clipboard&&navigator.clipboard.writeText(`Username: ${s.username}
Password: ${s.tempPassword}`).then(()=>{console.log("Credenziali copiate negli appunti")})):alert("Errore nel reset password: "+(s.error||"Password temporanea non generata"))}catch(e){alert("Errore nel reset della password")}},x=async e=>{try{let t=await fetch(`/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"activate"})}),s=await t.json();s.success?(await o(),alert("Utente riattivato")):alert("Errore nella riattivazione: "+s.error)}catch(e){alert("Errore nella riattivazione dell'utente")}},u=async e=>{try{let t=await fetch(`/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:"deactivate"})}),s=await t.json();s.success?(await o(),alert("Utente disattivato")):alert("Errore nella disattivazione: "+s.error)}catch(e){alert("Errore nella disattivazione dell'utente")}},h=e=>new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),g=e.filter(e=>!e.approved_at&&!e.rejected_at&&"sopralluoghista"===e.role&&e.attivo),p=e.filter(e=>e.approved_at||"admin"===e.role);return s?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Caricamento utenti..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"\uD83D\uDC65 Gestione Utenti"}),a.jsx("p",{className:"text-gray-600",children:"Approva nuovi sopralluoghisti e gestisci gli account"})]}),l&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"text-red-600",children:["❌ ",l]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:g.length}),a.jsx("div",{className:"text-yellow-800 text-sm",children:"Da Approvare"})]}),a.jsx("div",{className:"text-yellow-400 text-2xl",children:"⏳"})]})}),a.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.length}),a.jsx("div",{className:"text-green-800 text-sm",children:"Approvati"})]}),a.jsx("div",{className:"text-green-400 text-2xl",children:"✅"})]})}),a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),a.jsx("div",{className:"text-blue-800 text-sm",children:"Totali"})]}),a.jsx("div",{className:"text-blue-400 text-2xl",children:"\uD83D\uDC65"})]})})]}),g.length>0&&(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-yellow-800 mb-4",children:["⏳ Utenti in Attesa di Approvazione (",g.length,")"]}),a.jsx("div",{className:"space-y-4",children:g.map(e=>a.jsx("div",{className:"bg-white p-4 rounded-lg border border-yellow-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[e.nome," ",e.cognome]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["@",e.username]}),a.jsx("div",{className:"text-sm text-gray-500",children:e.email}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["Registrato: ",h(e.created_at)]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>d(e.id),className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors text-sm",children:"✅ Approva"}),a.jsx("button",{onClick:()=>c(e.id),className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm",children:"❌ Rifiuta"})]})]})},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Tutti gli Utenti"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(e=>a.jsx("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mr-4",children:a.jsx("span",{className:"text-gray-600 font-medium",children:e.nome?e.nome.charAt(0).toUpperCase():e.username.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[e.nome," ",e.cognome,a.jsx("span",{className:`ml-2 px-2 py-1 text-xs font-medium rounded-full ${"admin"===e.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:e.role.toUpperCase()})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["@",e.username," • ",e.email]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.approved_at?`Approvato: ${h(e.approved_at)}`:e.rejected_at?`Rifiutato: ${h(e.rejected_at)}`:"In attesa di approvazione",e.password_reset_required&&a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:"\uD83D\uDD11 Reset Password Richiesto"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${e.attivo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.attivo?"Attivo":"Disattivo"}),e.approved_at?a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"✅ Approvato"}):e.rejected_at?a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"❌ Rifiutato"}):a.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:"⏳ Pending"})]}),"admin"!==e.role&&(0,a.jsxs)("div",{className:"flex flex-col gap-1 ml-2",children:[a.jsx("button",{onClick:()=>m(e.id),className:"bg-orange-500 text-white px-2 py-1 rounded text-xs hover:bg-orange-600 transition-colors",children:"\uD83D\uDD11 Reset Password"}),e.attivo?a.jsx("button",{onClick:()=>u(e.id),className:"bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition-colors",children:"❌ Disattiva"}):a.jsx("button",{onClick:()=>x(e.id),className:"bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600 transition-colors",children:"✅ Attiva"})]})]})]})},e.id))})]})]})}function S(){let[e,t]=(0,i.useState)("lavorazioni"),[s,r]=(0,i.useState)([]),[l,n]=(0,i.useState)(!0),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)("tutte"),[x,u]=(0,i.useState)(null),[h,g]=(0,i.useState)(!1),[p,b]=(0,i.useState)(""),[j,v]=(0,i.useState)(""),f=(0,i.useCallback)(async()=>{n(!0);try{let e="tutte"!==c?`/api/lavorazioni?stato=${c}`:"/api/lavorazioni",t=await fetch(e),s=await t.json();s.success?r(s.data):d(s.error)}catch(e){d("Errore nel caricamento delle lavorazioni")}n(!1)},[c]),y=async(e,t,s)=>{try{let a=await fetch(`/api/lavorazioni/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({azione:t,nota:s})}),i=await a.json();i.success?(f(),g(!1),b(""),u(null)):d(i.error)}catch(e){d("Errore nell'esecuzione dell'azione")}},N=(e,t)=>{u(e),v(t),g(!0)},w=e=>new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),C=e=>{switch(e){case"da_eseguire":return"bg-blue-100 text-blue-800";case"in_corso":return"bg-yellow-100 text-yellow-800";case"completata":return"bg-green-100 text-green-800";case"riaperta":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},D=e=>{switch(e){case"da_eseguire":return"�";case"in_corso":return"⏳";case"completata":return"✅";case"riaperta":return"\uD83D\uDD04";default:return"❓"}},S={totali:s.length,da_eseguire:s.filter(e=>"da_eseguire"===e.stato).length,in_corso:s.filter(e=>"in_corso"===e.stato).length,completata:s.filter(e=>"completata"===e.stato).length,riaperte:s.filter(e=>"riaperta"===e.stato).length};return l?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Caricamento lavorazioni..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Pannello Amministratore"}),a.jsx("p",{className:"text-gray-600",children:"Gestisci lavorazioni, utenti e configurazioni del sistema"})]}),a.jsx("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[a.jsx("button",{onClick:()=>t("lavorazioni"),className:`py-2 px-1 border-b-2 font-medium text-sm ${"lavorazioni"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"\uD83D\uDD27 Lavorazioni"}),a.jsx("button",{onClick:()=>t("utenti"),className:`py-2 px-1 border-b-2 font-medium text-sm ${"utenti"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"\uD83D\uDC65 Utenti"})]})}),"utenti"===e&&a.jsx(k,{}),"lavorazioni"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:S.totali}),a.jsx("div",{className:"text-blue-800 text-sm",children:"Totali"})]}),a.jsx("div",{className:"text-blue-400 text-2xl",children:"\uD83D\uDCCA"})]})}),a.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:S.da_eseguire}),a.jsx("div",{className:"text-yellow-800 text-sm",children:"Da Eseguire"})]}),a.jsx("div",{className:"text-yellow-400 text-2xl",children:"⏳"})]})}),a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:S.in_corso}),a.jsx("div",{className:"text-blue-800 text-sm",children:"In Corso"})]}),a.jsx("div",{className:"text-blue-400 text-2xl",children:"\uD83D\uDD04"})]})}),a.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:S.completata}),a.jsx("div",{className:"text-green-800 text-sm",children:"Completate"})]}),a.jsx("div",{className:"text-green-400 text-2xl",children:"✅"})]})}),a.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:S.riaperte}),a.jsx("div",{className:"text-orange-800 text-sm",children:"Riaperte"})]}),a.jsx("div",{className:"text-orange-400 text-2xl",children:"\uD83D\uDD04"})]})})]}),(0,a.jsxs)("div",{className:"flex gap-4 items-center",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filtra per stato:"}),(0,a.jsxs)("select",{value:c,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Filtra lavorazioni per stato",children:[a.jsx("option",{value:"tutte",children:"Tutte le lavorazioni"}),a.jsx("option",{value:"aperta",children:"Solo aperte"}),a.jsx("option",{value:"chiusa",children:"Solo chiuse"}),a.jsx("option",{value:"riaperta",children:"Solo riaperte"})]}),(0,a.jsxs)("button",{onClick:f,className:"bg-gray-100 text-gray-600 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDD04"}),"Ricarica"]})]}),o&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"text-red-600",children:["❌ ",o]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:0===s.length?(0,a.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCCB"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Nessuna lavorazione trovata"}),a.jsx("p",{children:"Non ci sono lavorazioni che corrispondono ai filtri selezionati"})]}):a.jsx("div",{className:"divide-y divide-gray-200",children:s.map(e=>a.jsx("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:D(e.stato)}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${C(e.stato)}`,children:e.stato.toUpperCase()}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e.descrizione}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1 mb-3",children:[(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Aperta:"})," ",w(e.data_apertura)]}),e.data_chiusura&&(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Chiusa:"})," ",w(e.data_chiusura)]}),e.data_riapertura&&(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Riaperta:"})," ",w(e.data_riapertura)]})]}),e.note.length>0&&(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md mb-3",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:["Note (",e.note.length,"):"]}),a.jsx("div",{className:"space-y-2",children:e.note.map((e,t)=>(0,a.jsxs)("div",{className:"text-sm text-gray-600 flex items-start",children:[a.jsx("span",{className:"text-blue-500 mr-2",children:"•"}),e]},t))})]}),e.verifica?.dati_verifica&&Object.entries(e.verifica.dati_verifica).some(([e,t])=>Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0].startsWith("data:image"))&&(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-3",children:"\uD83D\uDCF7 Foto Allegate"}),a.jsx("div",{className:"space-y-4",children:Object.entries(e.verifica.dati_verifica).filter(([e,t])=>Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0].startsWith("data:image")).map(([e,t])=>a.jsx(z,{foto:t,nome:e},e))})]})]}),(0,a.jsxs)("div",{className:"ml-4 flex flex-col gap-2",children:[a.jsx("button",{onClick:()=>N(e,"aggiungi_nota"),className:"text-blue-600 hover:text-blue-800 text-sm px-3 py-1 border border-blue-200 rounded",children:"\uD83D\uDCDD Aggiungi Nota"}),("da_eseguire"===e.stato||"in_corso"===e.stato)&&a.jsx("button",{onClick:()=>N(e,"completa"),className:"text-green-600 hover:text-green-800 text-sm px-3 py-1 border border-green-200 rounded",children:"✅ Completa"}),"completata"===e.stato&&a.jsx("button",{onClick:()=>N(e,"riapri"),className:"text-orange-600 hover:text-orange-800 text-sm px-3 py-1 border border-orange-200 rounded",children:"\uD83D\uDD04 Riapri"})]})]})},e.id))})}),h&&x&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 mx-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["chiudi"===j&&"Chiudi Lavorazione","riapri"===j&&"Riapri Lavorazione","aggiungi_nota"===j&&"Aggiungi Nota"]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[a.jsx("strong",{children:"Lavorazione:"})," ",x.descrizione]}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"aggiungi_nota"===j?"Nuova nota:":"Nota (opzionale):"}),a.jsx("textarea",{value:p,onChange:e=>b(e.target.value),placeholder:"Inserisci una nota...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Annulla"}),a.jsx("button",{onClick:()=>{x&&y(x.id,j,p)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"Conferma"})]})]})})]})]})}function _(){let{user:e}=n(),[t,s]=(0,i.useState)([]),[r,l]=(0,i.useState)(!0),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)(null),[x,u]=(0,i.useState)(!1),h=(0,i.useCallback)(async()=>{if(e?.id){l(!0);try{let t=await fetch(`/api/lavorazioni?utente=${e.id}`),a=await t.json();if(a.success){let t=a.data.filter(t=>t.utente_assegnato===e.id||"da_eseguire"===t.stato||"riaperta"===t.stato);s(t)}else d(a.error)}catch(e){d("Errore nel caricamento delle lavorazioni")}l(!1)}},[e?.id]),g=e=>{m(e),u(!0)},p=e=>{switch(e){case"da_eseguire":return{icon:"\uD83D\uDCCB",color:"bg-blue-100 text-blue-800",label:"DA ESEGUIRE",description:"Nuova verifica da completare"};case"in_corso":return{icon:"⏳",color:"bg-yellow-100 text-yellow-800",label:"IN CORSO",description:"Verifica in fase di esecuzione"};case"riaperta":return{icon:"\uD83D\uDD04",color:"bg-orange-100 text-orange-800",label:"RIAPERTA",description:"Verifica da ricontrollare"};case"completata":return{icon:"✅",color:"bg-green-100 text-green-800",label:"COMPLETATA",description:"Verifica terminata con successo"};default:return{icon:"❓",color:"bg-gray-100 text-gray-800",label:"SCONOSCIUTO",description:"Stato non definito"}}},b=e=>new Date(e).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),j={totali:t.length,da_eseguire:t.filter(e=>"da_eseguire"===e.stato).length,in_corso:t.filter(e=>"in_corso"===e.stato).length,completate:t.filter(e=>"completata"===e.stato).length,riaperte:t.filter(e=>"riaperta"===e.stato).length};return r?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Caricamento lavorazioni..."})]}):x&&c?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-800",children:["Verifica: ",c.descrizione]}),a.jsx("button",{onClick:()=>{u(!1),m(null)},className:"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md",children:"← Torna alle lavorazioni"})]}),a.jsx(D,{lavorazione:c,onLavorazioneComplete:e=>{h(),m(null),u(!1)},onBack:()=>{m(null),u(!1)}})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"\uD83D\uDC77 Pannello Sopralluoghista"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Benvenuto ",(0,a.jsxs)("strong",{children:[e?.nome," ",e?.cognome]}),"! Qui trovi tutte le verifiche assegnate da completare."]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.totali}),a.jsx("div",{className:"text-blue-800 text-sm",children:"Totali"})]}),a.jsx("div",{className:"text-blue-400 text-2xl",children:"\uD83D\uDCCA"})]})}),a.jsx("div",{className:"bg-indigo-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:j.da_eseguire}),a.jsx("div",{className:"text-indigo-800 text-sm",children:"Da Eseguire"})]}),a.jsx("div",{className:"text-indigo-400 text-2xl",children:"\uD83D\uDCCB"})]})}),a.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:j.in_corso}),a.jsx("div",{className:"text-yellow-800 text-sm",children:"In Corso"})]}),a.jsx("div",{className:"text-yellow-400 text-2xl",children:"⏳"})]})}),a.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:j.completate}),a.jsx("div",{className:"text-green-800 text-sm",children:"Completate"})]}),a.jsx("div",{className:"text-green-400 text-2xl",children:"✅"})]})}),a.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:j.riaperte}),a.jsx("div",{className:"text-orange-800 text-sm",children:"Riaperte"})]}),a.jsx("div",{className:"text-orange-400 text-2xl",children:"\uD83D\uDD04"})]})})]}),o&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"text-red-600",children:["❌ ",o]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:0===t.length?(0,a.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCCB"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Nessuna lavorazione assegnata"}),a.jsx("p",{children:"Al momento non hai verifiche da completare."}),a.jsx("p",{className:"text-sm mt-2",children:"Le nuove lavorazioni appariranno qui quando verranno assegnate dall'amministratore."})]}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Le tue Verifiche (",t.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{let t=p(e.stato);return(0,a.jsxs)("div",{className:"border rounded-lg p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>g(e),children:[a.jsx("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-3xl mr-3",children:t.icon}),a.jsx("div",{children:a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.color}`,children:t.label})})]})}),a.jsx("h4",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:e.descrizione}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.description}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"Assegnata:"})," ",e.data_assegnazione?b(e.data_assegnazione):b(e.data_apertura)]}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"ID:"})," ",e.id.substring(0,8),"..."]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Clicca per ","completata"===e.stato?"visualizzare":"iniziare"]}),a.jsx("span",{className:"text-blue-500",children:"→"})]})})]},e.id)})})]})})]})}function A({onNavigate:e}){let[t,s]=(0,i.useState)({condomini:{totali:0,attivi:0,inattivi:0},tipologie:{totali:0,attive:0,inattive:0},verifiche:{totali:0,verificheCompletate:0,inCorso:0,scadute:0},lavorazioni:{totali:0,da_eseguire:0,in_corso:0,completate:0}}),[r,l]=(0,i.useState)(!0);return r?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Caricamento statistiche..."})]}):(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Dashboard"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-blue-50 p-6 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Condomini Attivi"}),a.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:r?"...":t.condomini.attivi})]}),a.jsx("div",{className:"text-blue-400 text-3xl",children:"\uD83C\uDFE2"})]})}),a.jsx("div",{className:"bg-green-50 p-6 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Verifiche Completate"}),a.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:t.verifiche.verificheCompletate})]}),a.jsx("div",{className:"text-green-400 text-3xl",children:"✅"})]})}),a.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"In Corso"}),a.jsx("p",{className:"text-3xl font-bold text-yellow-600 mt-2",children:t.verifiche.inCorso})]}),a.jsx("div",{className:"text-yellow-400 text-3xl",children:"⏳"})]})}),a.jsx("div",{className:"bg-red-50 p-6 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"Scadute"}),a.jsx("p",{className:"text-3xl font-bold text-red-600 mt-2",children:t.verifiche.scadute})]}),a.jsx("div",{className:"text-red-400 text-3xl",children:"⚠️"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Condomini Recenti",a.jsx("span",{className:"ml-2 text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:t.condomini.totali})]}),r?(0,a.jsxs)("div",{className:"animate-pulse space-y-3",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]}):t.condomini.totali>0?(0,a.jsxs)("div",{className:"p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.condomini.totali}),a.jsx("div",{className:"text-sm text-gray-500",children:"condomini registrati"})]}):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nessun condominio presente"})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Azioni Rapide"}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("button",{onClick:()=>e?.("condomini"),className:"w-full text-left p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"\uD83C\uDFE2"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Nuovo Condominio"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Aggiungi un nuovo condominio al sistema"})]})]})}),a.jsx("button",{onClick:()=>e?.("verifiche"),className:"w-full text-left p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-green-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"✅"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Nuova Verifica"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Avvia il wizard per una nuova verifica"})]})]})}),a.jsx("button",{onClick:()=>e?.("tipologie"),className:"w-full text-left p-4 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"\uD83D\uDCCB"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Tipologie Verifiche"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Gestisci le tipologie di verifica"})]})]})}),a.jsx("button",{onClick:()=>e?.("admin"),className:"w-full text-left p-4 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"⚙️"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Pannello Admin"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Gestisci lavorazioni e riapri verifiche"})]})]})})]})]})]})]})}function E(){let{isAuthenticated:e,user:t,role:s,logout:r}=n(),[l,o]=(0,i.useState)("admin"===s?"dashboard":"lavorazioni"),c="admin"===s?[{id:"dashboard",name:"Dashboard",icon:"\uD83C\uDFE0"},{id:"condomini",name:"Condomini",icon:"\uD83C\uDFE2"},{id:"tipologie",name:"Tipologie",icon:"\uD83D\uDCCB"},{id:"verifiche",name:"Nuova Verifica",icon:"✅"},{id:"admin",name:"Gestione Lavorazioni",icon:"⚙️"}]:[{id:"lavorazioni",name:"Le Mie Lavorazioni",icon:"\uD83D\uDCCB"},{id:"completate",name:"Completate",icon:"✅"}];return e?(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,a.jsxs)("nav",{className:"w-64 bg-white shadow-lg",children:[a.jsx("div",{className:"p-6",children:a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Verifiche Condominiali"})}),a.jsx("ul",{className:"mt-6",children:c.map(e=>a.jsx("li",{children:(0,a.jsxs)("button",{onClick:()=>o(e.id),className:`w-full flex items-center px-6 py-3 text-left hover:bg-blue-50 transition-colors ${l===e.id?"bg-blue-100 border-r-4 border-blue-500 text-blue-700":"text-gray-600"}`,children:[a.jsx("span",{className:"text-2xl mr-3",children:e.icon}),e.name]})},e.id))})]}),(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:c.find(e=>e.id===l)?.name}),a.jsx("p",{className:"text-sm text-gray-500",children:"admin"===s?"Pannello Amministratore":"Pannello Sopralluoghista"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-700",children:[t?.nome," ",t?.cognome]}),a.jsx("div",{className:"text-xs text-gray-500",children:"admin"===s?"\uD83D\uDC51 Amministratore":"\uD83D\uDC77 Sopralluoghista"})]}),a.jsx("button",{onClick:r,className:"px-3 py-1 text-sm text-red-600 hover:text-red-800 border border-red-300 rounded hover:bg-red-50 transition-colors",title:"Disconnetti",children:"\uD83D\uDEAA Esci"})]})]})}),(0,a.jsxs)("div",{className:"p-8",children:["admin"===s&&(0,a.jsxs)(a.Fragment,{children:["dashboard"===l&&a.jsx(A,{onNavigate:o}),"condomini"===l&&a.jsx(g,{}),"tipologie"===l&&a.jsx(f,{}),"verifiche"===l&&a.jsx(D,{}),"admin"===l&&a.jsx(S,{})]}),"sopralluoghista"===s&&(0,a.jsxs)(a.Fragment,{children:["lavorazioni"===l&&a.jsx(_,{}),"completate"===l&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[a.jsx("div",{className:"text-4xl mb-4",children:"✅"}),a.jsx("h3",{className:"text-xl font-medium mb-2",children:"Lavorazioni Completate"}),a.jsx("p",{children:"Qui vedrai lo storico delle verifiche che hai completato."}),a.jsx("p",{className:"text-sm mt-2 text-gray-400",children:"Funzionalit\xe0 in sviluppo..."})]})})]})]})]})]}):a.jsx(d,{})}function T(){return a.jsx(l,{children:a.jsx(E,{})})}},3733:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>r,viewport:()=>l});var a=s(2051);s(5023);let i="Verifiche Condominiali",r={title:i,description:"App PWA per gestione verifiche condominiali",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"default",title:i},formatDetection:{telephone:!1},icons:{icon:"/icon-192.png",apple:"/apple-icon.png"}},l={themeColor:"#3b82f6"};function n({children:e}){return a.jsx("html",{lang:"it",children:a.jsx("body",{className:"min-h-screen bg-gray-50",children:e})})}},4148:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(5347).createProxy)(String.raw`/Users/akirayouky/Desktop/Siti/Condomini/src/app/page.tsx#default`)},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[787,39],()=>s(2887));module.exports=a})();