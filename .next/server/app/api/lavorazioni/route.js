"use strict";(()=>{var e={};e.id=827,e.ids=[827],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},8815:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>I,patchFetch:()=>_,requestAsyncStorage:()=>z,routeModule:()=>v,serverHooks:()=>q,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{GET:()=>g,POST:()=>f});var i=t(3278),a=t(5002),s=t(4877),n=t(1309);let l=require("node:crypto"),c={randomUUID:l.randomUUID},d=new Uint8Array(256),u=d.length,m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));var p=t(2557);async function g(e){try{let{searchParams:r}=new URL(e.url),t=r.get("stato"),o=r.get("verifica_id"),i=r.get("utente_assegnato"),a=p.$.lavorazioni.getAll();t&&"tutte"!==t&&(a=a.eq("stato",t)),o&&(a=a.eq("verifica_id",o)),i&&(a=a.eq("utente_assegnato",i));let{data:s,error:l}=await a;if(l)return console.error("Errore Supabase GET lavorazioni:",l),n.NextResponse.json({success:!1,error:"Errore nel recupero delle lavorazioni"},{status:500});return n.NextResponse.json({success:!0,data:s||[],total:s?.length||0})}catch(e){return console.error("Errore GET lavorazioni:",e),n.NextResponse.json({success:!1,error:"Errore nel recupero delle lavorazioni"},{status:500})}}async function f(e){try{var r,t;let{verifica_id:o,descrizione:i,note:a,utente_assegnato:s}=await e.json();if(!o||!i)return n.NextResponse.json({success:!1,error:"Verifica ID e descrizione sono obbligatori"},{status:400});let g=new Date().toISOString(),f={id:c.randomUUID?c.randomUUID():function(e,r,t){let o=(e=e||{}).random??e.rng?.()??(u>d.length-16&&((0,l.randomFillSync)(d),u=0),d.slice(u,u+=16));if(o.length<16)throw Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r){if((t=t||0)<0||t+16>r.length)throw RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let e=0;e<16;++e)r[t+e]=o[e];return r}return function(e,r=0){return(m[e[r+0]]+m[e[r+1]]+m[e[r+2]]+m[e[r+3]]+"-"+m[e[r+4]]+m[e[r+5]]+"-"+m[e[r+6]]+m[e[r+7]]+"-"+m[e[r+8]]+m[e[r+9]]+"-"+m[e[r+10]]+m[e[r+11]]+m[e[r+12]]+m[e[r+13]]+m[e[r+14]]+m[e[r+15]]).toLowerCase()}(o)}(r,t,void 0),verifica_id:o,stato:"da_eseguire",descrizione:i.trim(),note:a?[a]:[],data_apertura:g,utente_assegnato:s},{data:v,error:z}=await p.$.lavorazioni.create(f);if(z)return console.error("Errore Supabase POST lavorazione:",z),n.NextResponse.json({success:!1,error:"Errore nella creazione della lavorazione"},{status:500});return n.NextResponse.json({success:!0,data:v,message:"Lavorazione creata con successo"},{status:201})}catch(e){return console.error("Errore POST lavorazione:",e),n.NextResponse.json({success:!1,error:"Errore nella creazione della lavorazione"},{status:500})}}let v=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/lavorazioni/route",pathname:"/api/lavorazioni",filename:"route",bundlePath:"app/api/lavorazioni/route"},resolvedPagePath:"/Users/akirayouky/Desktop/Siti/Condomini/src/app/api/lavorazioni/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:z,staticGenerationAsyncStorage:h,serverHooks:q}=v,I="/api/lavorazioni/route";function _(){return(0,s.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:h})}},2557:(e,r,t)=>{t.d(r,{$:()=>i,O:()=>o});let o=(0,t(5932).eI)("https://ygvlcikgzkoaxlrmwsnv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlndmxjaWtnemtvYXhscm13c252Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzOTgzMzgsImV4cCI6MjA3NDk3NDMzOH0.Zc6eihyJiTZy6WicV6MyIgZ1Oq7GwzRYR01zovQHFPs"),i={condomini:{getAll:()=>o.from("condomini").select("*").order("data_inserimento",{ascending:!1}),create:e=>o.from("condomini").insert([e]).select().single(),getById:e=>o.from("condomini").select("*").eq("id",e).single(),update:(e,r)=>o.from("condomini").update(r).eq("id",e).select().single(),delete:e=>o.from("condomini").delete().eq("id",e)},tipologie:{getAll:()=>o.from("tipologie_verifiche").select("*").order("data_creazione",{ascending:!1}),create:e=>o.from("tipologie_verifiche").insert([e]).select().single(),getById:e=>o.from("tipologie_verifiche").select("*").eq("id",e).single(),update:(e,r)=>o.from("tipologie_verifiche").update(r).eq("id",e).select().single(),delete:e=>o.from("tipologie_verifiche").delete().eq("id",e)},verifiche:{getAll:()=>o.from("verifiche").select("*").order("data_creazione",{ascending:!1}),create:e=>o.from("verifiche").insert([e]).select().single(),getById:e=>o.from("verifiche").select("*").eq("id",e).single(),update:(e,r)=>o.from("verifiche").update(r).eq("id",e).select().single(),delete:e=>o.from("verifiche").delete().eq("id",e)},lavorazioni:{getAll:()=>o.from("lavorazioni").select("*").order("data_apertura",{ascending:!1}),create:e=>o.from("lavorazioni").insert([e]).select().single(),getById:e=>o.from("lavorazioni").select("*").eq("id",e).single(),update:(e,r)=>o.from("lavorazioni").update(r).eq("id",e).select().single(),delete:e=>o.from("lavorazioni").delete().eq("id",e)},users:{getAll:()=>o.from("users").select("id, username, email, role, nome, cognome, telefono, attivo, created_at, last_login, approved_at").order("created_at",{ascending:!1}),create:e=>o.from("users").insert([e]).select("id, username, email, role, nome, cognome, telefono, attivo, created_at").single(),getById:e=>o.from("users").select("id, username, email, role, nome, cognome, telefono, attivo, created_at, last_login, approved_at").eq("id",e).single(),getByUsername:e=>o.from("users").select("*").eq("username",e).single(),getByEmail:e=>o.from("users").select("*").eq("email",e).single(),update:(e,r)=>o.from("users").update(r).eq("id",e).select("id, username, email, role, nome, cognome, telefono, attivo, created_at, last_login, approved_at").single(),updateLastLogin:e=>o.from("users").update({last_login:new Date().toISOString()}).eq("id",e),delete:e=>o.from("users").delete().eq("id",e)}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[787,829],()=>t(8815));module.exports=o})();