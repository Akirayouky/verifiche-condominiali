(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[521],{2379:function(e,s,t){Promise.resolve().then(t.bind(t,2210))},2210:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return i}});var n=t(7437),o=t(2265);function i(){let[e,s]=(0,o.useState)(null),[t,i]=(0,o.useState)(!1),a=async()=>{i(!0);try{let e=await fetch("/api/debug-notifiche"),t=await e.json();s(t)}catch(e){s({error:"Errore connessione",details:e})}finally{i(!1)}},l=async()=>{i(!0);try{let t=await fetch("/api/debug-notifiche",{method:"POST",headers:{"Content-Type":"application/json"}}),n=await t.json();s({...e,testCreation:n})}catch(t){s({...e,testCreation:{error:"Errore creazione test",details:t}})}finally{i(!1)}};return(0,n.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"\uD83D\uDD0D Debug Sistema Notifiche"}),(0,n.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,n.jsx)("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:t?"Caricamento...":"\uD83D\uDCCA Verifica Notifiche Database"}),(0,n.jsx)("button",{onClick:l,disabled:t,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50",children:t?"Creando...":"\uD83E\uDDEA Crea Notifica Test"}),(0,n.jsx)("button",{onClick:()=>{let e=new EventSource("/api/notifications/stream?userId=".concat("e1017f5d-83e1-4da3-ac81-4924a0dfd010"));console.log("\uD83D\uDD17 Apertura connessione SSE..."),e.onopen=()=>{console.log("✅ Connessione SSE aperta"),s(e=>({...e,sse:{status:"connected",time:new Date().toISOString()}}))},e.onmessage=e=>{console.log("\uD83D\uDCE8 Messaggio SSE ricevuto:",e.data);let t=JSON.parse(e.data);s(e=>{var s;return{...e,sse:{...null==e?void 0:e.sse,lastMessage:t,messagesCount:((null==e?void 0:null===(s=e.sse)||void 0===s?void 0:s.messagesCount)||0)+1}}})},e.onerror=e=>{console.error("❌ Errore SSE:",e),s(e=>({...e,sse:{...null==e?void 0:e.sse,error:"Connection error"}}))},setTimeout(()=>{e.close(),console.log("\uD83D\uDD0C Connessione SSE chiusa dopo test")},1e4)},className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700",children:"\uD83D\uDD17 Test Connessione SSE (10s)"})]}),e&&(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"\uD83D\uDCCB Risultati Debug"}),(0,n.jsx)("pre",{className:"text-sm overflow-auto bg-white p-3 rounded border",children:JSON.stringify(e,null,2)})]}),(0,n.jsxs)("div",{className:"mt-8 p-4 bg-yellow-50 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"\uD83D\uDCDD Checklist Debug"}),(0,n.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,n.jsx)("li",{children:"1. ✅ Le notifiche vengono salvate nel database?"}),(0,n.jsx)("li",{children:"2. ✅ L'endpoint SSE funziona e invia messaggi?"}),(0,n.jsx)("li",{children:"3. ❓ Il NotificationCenter riceve i messaggi SSE?"}),(0,n.jsx)("li",{children:"4. ❓ Le notifiche appaiono nell'interfaccia?"})]})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2379)}),_N_E=e.O()}]);