(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[311],{1909:function(e,s,t){Promise.resolve().then(t.bind(t,8810))},8810:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var a=t(7437),i=t(2265),c=t(5526);function o(){let[e,s]=(0,i.useState)([]),[t,o]=(0,i.useState)(!1),r=e=>{s(s=>[e,...s])},n=async()=>{o(!0);try{let{data:e,error:s}=await c.O.from("notifiche").select("count").limit(1);s?r({success:!1,message:"❌ Errore connessione DB: ".concat(s.message)}):r({success:!0,message:"✅ Connessione database OK"})}catch(e){r({success:!1,message:"❌ Errore: ".concat(e instanceof Error?e.message:"Sconosciuto")})}o(!1)},l=async()=>{o(!0);try{let e={tipo:"nuova_assegnazione",titolo:"Test Notifica da UI",messaggio:"Test creazione notifica dall'interfaccia",utente_id:crypto.randomUUID(),priorita:"media",letta:!1},{data:s,error:t}=await c.O.from("notifiche").insert(e).select().single();t?r({success:!1,message:"❌ Errore creazione notifica: ".concat(t.message)}):r({success:!0,message:"✅ Notifica creata con successo",data:{id:s.id,tipo:s.tipo,titolo:s.titolo}})}catch(e){r({success:!1,message:"❌ Errore: ".concat(e instanceof Error?e.message:"Sconosciuto")})}o(!1)},d=async()=>{o(!0);try{let{data:e,error:s}=await c.O.from("notifiche").select("id, tipo, titolo, priorita, letta, data_creazione").order("data_creazione",{ascending:!1}).limit(5);s?r({success:!1,message:"❌ Errore lettura notifiche: ".concat(s.message)}):r({success:!0,message:"✅ Lette ".concat(e.length," notifiche"),data:e})}catch(e){r({success:!1,message:"❌ Errore: ".concat(e instanceof Error?e.message:"Sconosciuto")})}o(!1)},u=async()=>{o(!0);try{let{data:e,error:s}=await c.O.from("notifiche").select("id").eq("letta",!1).limit(1);if(s||!e||0===e.length){r({success:!1,message:"❌ Nessuna notifica non letta trovata per il test update"}),o(!1);return}let{data:t,error:a}=await c.O.from("notifiche").update({letta:!0}).eq("id",e[0].id).select().single();a?r({success:!1,message:"❌ Errore update notifica: ".concat(a.message)}):r({success:!0,message:"✅ Notifica marcata come letta",data:{id:t.id,letta:t.letta}})}catch(e){r({success:!1,message:"❌ Errore: ".concat(e instanceof Error?e.message:"Sconosciuto")})}o(!1)},m=async()=>{s([]),await n(),await new Promise(e=>setTimeout(e,500)),await l(),await new Promise(e=>setTimeout(e,500)),await d(),await new Promise(e=>setTimeout(e,500)),await u()};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"\uD83E\uDDEA Test Sistema Notifiche"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:n,disabled:t,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"\uD83D\uDD0C Test DB"}),(0,a.jsx)("button",{onClick:l,disabled:t,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"➕ Crea Notifica"}),(0,a.jsx)("button",{onClick:d,disabled:t,className:"bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"\uD83D\uDCD6 Leggi Notifiche"}),(0,a.jsx)("button",{onClick:u,disabled:t,className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"✏️ Update Notifica"})]}),(0,a.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:m,disabled:t,className:"bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded font-medium disabled:opacity-50",children:"\uD83D\uDE80 Test Completo"}),(0,a.jsx)("button",{onClick:()=>{s([])},disabled:t,className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded disabled:opacity-50",children:"\uD83D\uDDD1️ Pulisci Risultati"})]}),t&&(0,a.jsx)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-4",children:(0,a.jsx)("p",{className:"text-yellow-700",children:"⏳ Test in corso..."})}),(0,a.jsx)("div",{className:"space-y-4",children:e.map((e,s)=>(0,a.jsxs)("div",{className:"border-l-4 p-4 ".concat(e.success?"bg-green-100 border-green-500":"bg-red-100 border-red-500"),children:[(0,a.jsx)("p",{className:e.success?"text-green-700":"text-red-700",children:e.message}),e.data&&(0,a.jsx)("pre",{className:"mt-2 text-sm bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify(e.data,null,2)})]},s))}),0===e.length&&(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Clicca sui pulsanti per testare il sistema notifiche"})]})})})}},5526:function(e,s,t){"use strict";t.d(s,{O:function(){return a}});let a=(0,t(3887).eI)("https://ygvlcikgzkoaxlrmwsnv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlndmxjaWtnemtvYXhscm13c252Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzOTgzMzgsImV4cCI6MjA3NDk3NDMzOH0.Zc6eihyJiTZy6WicV6MyIgZ1Oq7GwzRYR01zovQHFPs")}},function(e){e.O(0,[887,971,117,744],function(){return e(e.s=1909)}),_N_E=e.O()}]);